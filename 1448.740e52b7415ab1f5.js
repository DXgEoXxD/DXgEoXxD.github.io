"use strict";(self.webpackChunkadasu=self.webpackChunkadasu||[]).push([[1448],{1448:(Q,u,n)=>{n.r(u),n.d(u,{LogsComponent:()=>P});var d=n(5861),h=n(6814),F=n(3999),r=n(38),p=n(6223),y=n(8645),$=n(5135),C=n(7034),D=n(2937),Z=n(8240),V=n(1721),R=n(1154),I=n(3970),t=n(9291),M=n(3304),f=n.n(M),s=n(2891);const O=[{Fecha:"2023-01-15T12:00:00",SocioId:"2",TipoEvento:s.$.RegistroPago},{Fecha:"2023-02-15T12:00:00",SocioId:"3",TipoEvento:s.$.RegistroPagoMasivo},{Fecha:"2023-03-15T12:00:00",SocioId:"4",TipoEvento:s.$.RegistroLicencia},{Fecha:"2023-04-15T12:00:00",SocioId:"5",TipoEvento:s.$.Alta},{Fecha:"2023-05-15T12:00:00",SocioId:"6",TipoEvento:s.$.Modificacion},{Fecha:"2023-06-15T12:00:00",SocioId:"7",TipoEvento:s.$.Baja},{Fecha:"2023-07-15T12:00:00",SocioId:"8",TipoEvento:s.$.RegistroPago},{Fecha:"2023-08-15T12:00:00",SocioId:"9",TipoEvento:s.$.RegistroPagoMasivo},{Fecha:"2023-09-15T12:00:00",SocioId:"10",TipoEvento:s.$.RegistroLicencia},{Fecha:"2023-10-15T12:00:00",SocioId:"1",TipoEvento:s.$.Alta},{Fecha:"2023-11-15T12:00:00",SocioId:"2",TipoEvento:s.$.Modificacion},{Fecha:"2023-12-15T12:00:00",SocioId:"3",TipoEvento:s.$.Baja},{Fecha:"2023-13-15T12:00:00",SocioId:"4",TipoEvento:s.$.RegistroPago},{Fecha:"2023-14-15T12:00:00",SocioId:"5",TipoEvento:s.$.RegistroPagoMasivo},{Fecha:"2023-15-15T12:00:00",SocioId:"6",TipoEvento:s.$.RegistroLicencia},{Fecha:"2023-16-15T12:00:00",SocioId:"7",TipoEvento:s.$.Alta},{Fecha:"2023-17-15T12:00:00",SocioId:"8",TipoEvento:s.$.Modificacion},{Fecha:"2023-18-15T12:00:00",SocioId:"9",TipoEvento:s.$.Baja},{Fecha:"2023-19-15T12:00:00",SocioId:"10",TipoEvento:s.$.Baja},{Fecha:"2023-20-15T12:00:00",SocioId:"1",TipoEvento:s.$.Alta}];var x=n(6633),E=n(7266);let U=(()=>{class i{constructor(o,e){this.options=o,this.sociosSV=e}get(o,e){var a=this;return(0,d.Z)(function*(){const[c,m]=yield Promise.all([a.options.get(Z.W.TiposEvento,e),a.sociosSV.get({},e)]);return O.filter(l=>{const T=o?.socioId,v=f()(l.Fecha),S=o?.dateFrom?f()(o?.dateFrom):null,L=o?.dateTo?f()(o?.dateTo):null,A=o?.eventType;return!(T&&l.SocioId!==T||S&&!(+v<+S)||L&&!(+v<+L)||A&&l.TipoEvento!==A)}).map(l=>{const T=(0,r.Ro)(c,l.TipoEvento,"Val")?.Desc||"N/D",v=(0,r.Ro)(m,l.SocioId,"Id");return{...l,EventoDesc:T,Socio:v}})})()}static#t=this.\u0275fac=function(e){return new(e||i)(t.LFG(x.I),t.LFG(E.B))};static#o=this.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function j(i,g){if(1&i){const o=t.EpF();t.TgZ(0,"button",18),t.NdJ("click",function(){t.CHM(o);const a=t.oxw(2);return t.KtG(a.loadLogs(!0))}),t._UZ(1,"reload-svg",19),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&i&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"Recargar")," "))}function Y(i,g){if(1&i){const o=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){t.CHM(o);const a=t.oxw(2);return t.KtG(a.loadLogs())}),t._UZ(1,"search-svg",19),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"button",21),t.NdJ("click",function(){t.CHM(o);const a=t.oxw(2);return t.KtG(a.restoreFilters())}),t._uU(5),t.ALo(6,"translate"),t.qZA()}2&i&&(t.xp6(2),t.hij(" ",t.lcZ(3,2,"Aplicar filtros")," "),t.xp6(3),t.hij(" ",t.lcZ(6,4,"Restablecer")," "))}function J(i,g){if(1&i&&(t.TgZ(0,"div",6)(1,"div",7),t._UZ(2,"app-combobox",8),t.qZA(),t.TgZ(3,"div",9),t._UZ(4,"app-combobox",10),t.qZA(),t.TgZ(5,"div",11),t._UZ(6,"app-input-date",12),t.qZA(),t.TgZ(7,"div",13),t._UZ(8,"app-input-date",14),t.qZA(),t.TgZ(9,"div",15),t.YNc(10,j,4,3,"button",16),t.YNc(11,Y,7,6,"ng-template",null,17,t.W1O),t.qZA()()),2&i){const o=t.MAs(12),e=t.oxw();t.xp6(2),t.Q6J("options",e.sociosList)("control",e.filters.get("socio")),t.xp6(2),t.Q6J("options",e.eventTypeList)("control",e.filters.get("eventType")),t.xp6(2),t.Q6J("control",e.filters.get("dateFrom")),t.xp6(2),t.Q6J("control",e.filters.get("dateTo")),t.xp6(2),t.Q6J("ngIf",!e.changedFilters)("ngIfElse",o)}}function N(i,g){if(1&i&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td",22),t._uU(7),t.ALo(8,"formatDate"),t.qZA()()),2&i){const o=g.$implicit,e=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,3,o.EventoDesc||"")),t.xp6(3),t.Oqu(null==o.Socio?null:o.Socio.NombreCompleto),t.xp6(2),t.Oqu(t.xi3(8,5,o.Fecha,e.DATETIME_FORMAT))}}let P=(()=>{class i{constructor(o,e,a,c,m){this.logsSV=o,this.formB=e,this.options=a,this.sociosSV=c,this.formatCI=m,this.DATETIME_FORMAT=$.Cu,this.logs=[],this.eventTypeList=[{Val:"",Desc:"Todos"}],this.sociosList=[{Val:"",Desc:"Todos"}],this.$destroy=new y.x}get filtersValue(){return{eventType:this.filters.get("eventType")?.value?.Val,socioId:this.filters.get("socio")?.value?.Val,dateFrom:this.filters.get("dateFrom")?.value,dateTo:this.filters.get("dateTo")?.value}}get changedFilters(){return!(0,r.Gt)(this.lastFiltersSearch,this.filtersValue)}ngOnDestroy(){this.$destroy.next(null)}ngOnInit(){var o=this;return(0,d.Z)(function*(){yield o.generateFilters(),o.loadLogs()})()}generateFilters(){var o=this;return(0,d.Z)(function*(){const[e,a]=yield Promise.all([o.options.get(Z.W.TiposEvento,{Instance:o}),o.sociosSV.get({},{Instance:o})]);o.eventTypeList.push(...e),o.sociosList.push(...a.map(c=>({...c,Val:c.Id,Desc:`${c.NombreCompleto} ${o.formatCI.transform(c.Documento)}`}))),o.filters=o.formB.group({eventType:[(0,r.Ro)(o.eventTypeList,"","Val"),[p.kI.required]],socio:[(0,r.Ro)(o.sociosList,"","Val"),[p.kI.required]],dateFrom:["",[p.kI.required]],dateTo:["",[p.kI.required]]})})()}restoreFilters(){this.filters.patchValue(this.lastFiltersSearch)}loadLogs(o){var e=this;return(0,d.Z)(function*(){e.logs=yield e.logsSV.get(e.filtersValue,{Instance:e,forceReload:o}),e.lastFiltersSearch=e.filtersValue})()}static#t=this.\u0275fac=function(e){return new(e||i)(t.Y36(U),t.Y36(p.qu),t.Y36(x.I),t.Y36(E.B),t.Y36(I.n))};static#o=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-logs"]],standalone:!0,features:[t._Bn([I.n]),t.jDz],decls:18,vars:11,consts:[[1,"row"],[1,"col12"],["class","filtros",4,"ngIf"],[1,"col12","margin-top"],[2,"width","1%"],[4,"ngFor","ngForOf"],[1,"filtros"],[1,"socio"],["label","Socio",1,"filter",3,"options","control"],[1,"tipoEvento"],["label","Tipo de evento",1,"filter",3,"options","control"],[1,"fechaDesde"],["label","Fecha desde",1,"filter",3,"control"],[1,"fechaHasta"],["label","Fecha hasta",1,"filter",3,"control"],[1,"reload","d-flex","align-end"],["class","primary flat fit-content",3,"click",4,"ngIf","ngIfElse"],["applyFilters",""],[1,"primary","flat","fit-content",3,"click"],[1,"white"],[1,"primary","flat","fit-content","margin-right-small",3,"click"],[1,"terciary","flat","fit-content",3,"click"],[1,"nowrap",2,"width","1%"]],template:function(e,a){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,J,13,8,"div",2),t.qZA(),t.TgZ(3,"div",3)(4,"table")(5,"thead")(6,"tr")(7,"th"),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"th"),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"th",4),t._uU(14),t.ALo(15,"translate"),t.qZA()()(),t.TgZ(16,"tbody"),t.YNc(17,N,9,8,"tr",5),t.qZA()()()()),2&e&&(t.xp6(2),t.Q6J("ngIf",!!a.filters),t.xp6(6),t.Oqu(t.lcZ(9,5,"Evento")),t.xp6(3),t.Oqu(t.lcZ(12,7,"Socio")),t.xp6(3),t.Oqu(t.lcZ(15,9,"Fecha")),t.xp6(3),t.Q6J("ngForOf",a.logs))},dependencies:[h.ez,h.sg,h.O5,F.aw,F.X$,r.ik,C.S,D.K,V.P,R.Y],styles:[".filtros[_ngcontent-%COMP%]{display:grid;gap:1rem;grid-template-columns:max-content max-content max-content max-content 1fr;grid-template-rows:auto}"]})}return i})()}}]);